<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏´‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏£‡∏±‡∏á‡∏™‡∏§‡∏©‡∏î‡∏¥‡πå</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
        body { 
            font-family: 'Sarabun', sans-serif; 
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .floating-animation {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .table-row-hover:hover {
            background: linear-gradient(90deg, rgba(249, 115, 22, 0.05) 0%, rgba(234, 88, 12, 0.05) 100%);
        }
        
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
        }
        
        /* Autocomplete Styles */
        .autocomplete-items {
            position: absolute;
            border: 1px solid #d1d5db;
            border-top: none;
            z-index: 99;
            top: 100%;
            left: 0;
            right: 0;
            max-height: 200px;
            overflow-y: auto;
            background-color: white;
            border-radius: 0 0 0.5rem 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .autocomplete-items div {
            padding: 10px;
            cursor: pointer;
            background-color: white;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .autocomplete-items div:hover {
            background-color: #f3f4f6;
        }
        
        .autocomplete-active {
            background-color: #fed7aa !important;
        }
        
        @media (max-width: 768px) {
            .mobile-text-sm { font-size: 0.875rem; }
            .mobile-text-xs { font-size: 0.75rem; }
            .mobile-px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
            .mobile-py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
            .mobile-hidden { display: none; }
            .mobile-block { display: block; }
            .mobile-full { width: 100%; }
            
            button, select, input[type="submit"] {
                min-height: 44px;
                touch-action: manipulation;
            }
            
            .table-container {
                -webkit-overflow-scrolling: touch;
                scrollbar-width: thin;
            }
            
            .table-container::-webkit-scrollbar {
                height: 4px;
            }
            
            .table-container::-webkit-scrollbar-track {
                background: #f1f1f1;
                border-radius: 2px;
            }
            
            .table-container::-webkit-scrollbar-thumb {
                background: #c1c1c1;
                border-radius: 2px;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-orange-50 to-amber-100 min-h-screen">
    <!-- Header -->
    <div class="glass-effect shadow-xl border-b border-white/20">
        <div class="max-w-6xl mx-auto px-4 md:px-6 py-4 md:py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3 md:space-x-4">
                    <div class="w-12 h-12 md:w-16 md:h-16 bg-gradient-to-br from-orange-600 to-amber-600 rounded-xl md:rounded-2xl flex items-center justify-center floating-animation shadow-lg">
                        <span class="text-white font-bold text-lg md:text-2xl">üìù</span>
                    </div>
                    <div class="flex-1 min-w-0">
                        <h1 class="text-xl md:text-3xl font-bold gradient-text truncate">‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</h1>
                        <p class="text-gray-600 text-sm md:text-lg truncate">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏´‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏£‡∏±‡∏á‡∏™‡∏§‡∏©‡∏î‡∏¥‡πå</p>
                        <div class="flex items-center space-x-2 mt-1">
                            <div class="w-2 h-2 bg-green-500 rounded-full pulse-animation"></div>
                            <span class="text-xs md:text-sm text-green-600 font-medium">‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
                        </div>
                    </div>
                </div>
                
                <!-- Admin Button -->
                <a href="admin-memo.html" class="group relative bg-gradient-to-r from-orange-600 via-amber-600 to-orange-600 hover:from-orange-700 hover:via-amber-700 hover:to-orange-700 text-white px-4 md:px-6 py-2 md:py-3 rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:scale-105 flex items-center space-x-2 overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 transform -skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div>
                    <span class="relative text-base md:text-lg animate-pulse">üë®‚Äçüíº</span>
                    <span class="relative font-bold text-sm md:text-base tracking-wide">Admin</span>
                    <svg class="relative w-4 h-4 md:w-5 md:h-5 transform group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                    </svg>
                </a>
            </div>
        </div>
    </div>

    <div class="max-w-6xl mx-auto px-4 md:px-6 py-4 md:py-8">
        <!-- Form Section -->
        <div class="glass-effect rounded-xl md:rounded-2xl shadow-2xl p-4 md:p-8 mb-6 md:mb-8 card-hover border border-white/20">
            <div class="flex items-center space-x-3 mb-4 md:mb-6">
                <div class="w-6 h-6 md:w-8 md:h-8 bg-gradient-to-r from-orange-500 to-amber-500 rounded-lg flex items-center justify-center">
                    <span class="text-white text-xs md:text-sm">‚úçÔ∏è</span>
                </div>
                <h2 class="text-lg md:text-2xl font-semibold gradient-text">‡∏Ç‡∏≠‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</h2>
            </div>
            
            <form id="memoForm" class="space-y-4 md:space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° *</label>
                    <input type="text" id="title" required class="w-full px-3 md:px-4 py-3 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏à‡∏≤‡∏Å *</label>
                    <select id="fromSelect" required class="w-full px-3 md:px-4 py-3 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á</option>
                        <option value="‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏´‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏£‡∏±‡∏á‡∏™‡∏§‡∏©‡∏î‡∏¥‡πå">‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏´‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏£‡∏±‡∏á‡∏™‡∏§‡∏©‡∏î‡∏¥‡πå</option>
                        <option value="other">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                    </select>
                    <div class="relative mt-3 hidden" id="fromOtherContainer">
                        <input type="text" id="fromOther" autocomplete="off" class="w-full px-3 md:px-4 py-3 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡πÄ‡∏£‡∏µ‡∏¢‡∏ô *</label>
                    <select id="toSelect" required class="w-full px-3 md:px-4 py-3 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö</option>
                        <option value="‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏´‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏£‡∏±‡∏á‡∏™‡∏§‡∏©‡∏î‡∏¥‡πå">‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏´‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏£‡∏±‡∏á‡∏™‡∏§‡∏©‡∏î‡∏¥‡πå</option>
                        <option value="‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏π‡πÅ‡∏•‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤">‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏π‡πÅ‡∏•‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option>
                        <option value="‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏¥‡∏ä‡∏≤">‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏¥‡∏ä‡∏≤</option>
                        <option value="‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞">‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞</option>
                        <option value="‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                        <option value="‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô">‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô</option>
                        <option value="other">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                    </select>
                    <input type="text" id="toOther" class="w-full px-3 md:px-4 py-3 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent mt-3 hidden" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ú‡∏π‡πâ‡∏Ç‡∏≠‡πÄ‡∏•‡∏Ç *</label>
                    <div class="relative" id="requestorAutocomplete">
                        <input type="text" id="requestor" required autocomplete="off" class="w-full px-3 md:px-4 py-3 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≠‡πÄ‡∏•‡∏Ç">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏≠‡∏∑‡πà‡∏ô‡πÜ</label>
                    <textarea id="notes" rows="3" class="w-full px-3 md:px-4 py-3 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)"></textarea>
                </div>

                <button type="submit" class="w-full bg-gradient-to-r from-orange-600 to-amber-600 hover:from-orange-700 hover:to-amber-700 text-white font-semibold py-4 px-6 rounded-xl transition duration-300 shadow-lg hover:shadow-xl transform hover:scale-[1.02] flex items-center justify-center space-x-2 min-h-[48px]">
                    <span>üìù</span>
                    <span class="text-sm md:text-base">‡∏Ç‡∏≠‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</span>
                </button>
            </form>
        </div>

        <!-- History Section -->
        <div class="glass-effect rounded-xl md:rounded-2xl shadow-2xl p-4 md:p-8 card-hover border border-white/20">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4 md:mb-6 space-y-3 md:space-y-0">
                <div class="flex items-center space-x-3 md:space-x-4">
                    <div class="w-6 h-6 md:w-8 md:h-8 bg-gradient-to-r from-orange-500 to-amber-500 rounded-lg flex items-center justify-center">
                        <span class="text-white text-xs md:text-sm">üìä</span>
                    </div>
                    <h2 class="text-lg md:text-2xl font-semibold gradient-text">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</h2>
                </div>
                <div class="flex items-center space-x-2">
                    <label class="text-sm font-medium text-gray-700">‡∏õ‡∏µ:</label>
                    <select id="yearFilter" class="px-3 md:px-4 py-2 text-sm md:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white">
                        <!-- Years will be populated by JavaScript -->
                    </select>
                </div>
            </div>
            
            <div class="overflow-x-auto rounded-xl border border-gray-200 table-container">
                <table class="w-full border-collapse bg-white/50 min-w-[600px]">
                    <thead>
                        <tr class="bg-gradient-to-r from-orange-50 to-amber-50">
                            <th class="border-b border-gray-200 px-3 md:px-6 py-3 md:py-4 text-left font-semibold text-gray-700 text-xs md:text-sm">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</th>
                            <th class="border-b border-gray-200 px-3 md:px-6 py-3 md:py-4 text-left font-semibold text-gray-700 text-xs md:text-sm">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</th>
                            <th class="border-b border-gray-200 px-3 md:px-6 py-3 md:py-4 text-left font-semibold text-gray-700 text-xs md:text-sm hidden md:table-cell">‡∏à‡∏≤‡∏Å</th>
                            <th class="border-b border-gray-200 px-3 md:px-6 py-3 md:py-4 text-left font-semibold text-gray-700 text-xs md:text-sm hidden md:table-cell">‡∏ñ‡∏∂‡∏á</th>
                            <th class="border-b border-gray-200 px-3 md:px-6 py-3 md:py-4 text-left font-semibold text-gray-700 text-xs md:text-sm">‡∏ú‡∏π‡πâ‡∏Ç‡∏≠‡πÄ‡∏•‡∏Ç</th>
                            <th class="border-b border-gray-200 px-3 md:px-6 py-3 md:py-4 text-left font-semibold text-gray-700 text-xs md:text-sm">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        </tr>
                    </thead>
                    <tbody id="historyTable">
                        <tr>
                            <td colspan="6" class="border-b border-gray-100 px-3 md:px-6 py-6 md:py-8 text-center text-gray-500">
                                <div class="flex items-center justify-center space-x-2">
                                    <div class="w-3 h-3 md:w-4 md:h-4 bg-orange-500 rounded-full animate-bounce"></div>
                                    <div class="w-3 h-3 md:w-4 md:h-4 bg-amber-500 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                                    <div class="w-3 h-3 md:w-4 md:h-4 bg-orange-600 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                                    <span class="ml-3 text-sm">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-orange-800 to-amber-900 text-white mt-8 md:mt-16">
        <div class="max-w-6xl mx-auto px-4 md:px-6 py-8 md:py-12">
            <div class="grid md:grid-cols-2 gap-6 md:gap-8">
                <div>
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="w-8 h-8 md:w-10 md:h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                            <span class="text-lg md:text-xl">üè´</span>
                        </div>
                        <h3 class="text-lg md:text-xl font-semibold">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</h3>
                    </div>
                    <p class="text-orange-100 leading-relaxed text-sm md:text-base">
                        ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏´‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏£‡∏±‡∏á‡∏™‡∏§‡∏©‡∏î‡∏¥‡πå<br>
                        ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°<br>
                        ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏° ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°
                    </p>
                </div>
                <div>
                    <h4 class="text-base md:text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">üìû</span>
                        ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
                    </h4>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-3">
                            <div class="w-6 h-6 md:w-8 md:h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                <span class="text-xs md:text-sm">üì±</span>
                            </div>
                            <span class="text-orange-100 text-sm md:text-base">0970283841(‡∏Ñ‡∏£‡∏π‡∏ß‡∏ä‡∏¥‡∏£‡∏≤‡∏û‡∏£)</span>
                        </div>
                        <div class="flex items-center space-x-3">
                            <div class="w-6 h-6 md:w-8 md:h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                <span class="text-xs md:text-sm">üíª</span>
                            </div>
                            <span class="text-orange-100 text-sm md:text-base">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="border-t border-orange-700 mt-6 md:mt-8 pt-6 md:pt-8 text-center">
                <p class="text-orange-200 text-xs md:text-sm">
                    ¬© 2024 ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏´‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏£‡∏±‡∏á‡∏™‡∏§‡∏©‡∏î‡∏¥‡πå - ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                </p>
            </div>
        </div>
    </footer>

    <!-- Memo Number Popup -->
    <div id="memoPopup" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl p-4 md:p-8 max-w-md w-full shadow-2xl">
            <div class="text-center mb-4 md:mb-6">
                <div class="w-12 h-12 md:w-16 md:h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4">
                    <span class="text-green-600 text-xl md:text-2xl">‚úÖ</span>
                </div>
                <h3 class="text-lg md:text-xl font-semibold text-gray-800">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h3>
            </div>
            
            <div class="bg-orange-50 rounded-lg p-3 md:p-4 mb-4 md:mb-6">
                <div class="text-center">
                    <div class="text-lg md:text-2xl font-bold text-orange-600 mb-2" id="memoNumber"></div>
                    <div class="text-xs md:text-sm text-gray-600">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</div>
                </div>
            </div>
            
            <div class="space-y-2 md:space-y-3 text-xs md:text-sm" id="memoDetails"></div>
            
            <button id="closePopup" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 mt-4 md:mt-6 min-h-[44px]">
                ‡∏õ‡∏¥‡∏î
            </button>
        </div>
    </div>

    <script>
        // Staff Names Data
        const staffNames = [
            "‡∏ô‡∏≤‡∏¢‡πÄ‡∏ó‡∏≠‡∏î‡πÑ‡∏ó‡∏¢ ‡∏´‡∏≠‡∏°‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥",
            "‡∏ô‡∏≤‡∏¢‡∏ì‡∏±‡∏ê‡∏û‡∏á‡∏®‡πå ‡∏ö‡∏∏‡∏ì‡∏¢‡∏≤‡∏£‡∏°‡∏¢‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ö‡∏∏‡∏ç‡∏¢‡∏ß‡∏µ‡∏£‡πå ‡∏õ‡∏≤‡∏Ç‡πâ‡∏≤‡∏á‡∏Æ‡∏∏‡∏á",
            "‡∏ô‡∏≤‡∏¢‡∏ß‡∏µ‡∏£‡∏∞‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏™‡∏≥‡∏£‡∏≤‡∏ç‡πÄ‡∏ô‡∏ï‡∏£",
            "‡∏ô‡∏≤‡∏¢‡∏≠‡∏†‡∏¥‡∏£‡∏±‡∏Å‡∏Ç‡∏†‡∏π‡∏°‡∏¥ ‡∏¢‡∏±‡∏ô‡∏ï‡∏∞‡∏ö‡∏∏‡∏®‡∏¢‡πå",
            "‡∏ô‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö ‡∏≠‡∏£‡∏£‡∏Ñ‡∏™‡∏±‡∏á‡∏Ç‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏Å‡∏•‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÄ‡∏ß‡∏µ‡∏¢‡∏á",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ô‡∏±‡∏ô‡∏ó‡∏ô‡∏≤ ‡πÇ‡∏û‡∏ò‡∏¥‡πå‡∏™‡∏∏",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏§‡∏ó‡∏±‡∏¢‡∏ß‡∏£‡∏£‡∏ì ‡∏ß‡∏á‡∏®‡πå‡∏ì‡∏∞‡∏£‡∏±‡∏ï‡∏ô‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ä‡πÑ‡∏°‡∏û‡∏£ ‡∏à‡∏¥‡∏ï‡∏£‡∏à‡∏±‡∏Å‡∏£",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏£‡∏ä‡∏∏‡∏°‡∏≤ ‡πÑ‡∏ä‡∏¢‡∏£‡∏≤‡∏ä",
            "‡∏ô‡∏≤‡∏¢‡∏ß‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå ‡πÅ‡∏Å‡πâ‡∏ß‡∏™‡∏∏‡∏£‡∏µ‡∏¢‡πå",
            "‡∏ô‡∏≤‡∏¢‡∏ß‡∏∏‡∏í‡∏¥‡∏ä‡∏±‡∏¢ ‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏î‡∏µ",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡∏ä‡∏¥‡∏£‡∏≤‡∏û‡∏£ ‡∏≠‡∏ô‡∏∏‡∏ß‡∏£‡∏£‡∏ì",
            "‡∏ô‡∏≤‡∏¢‡∏ô‡∏£‡∏≤‡∏ä‡∏¥‡∏ï ‡∏´‡∏±‡∏ï‡∏ñ‡∏°‡∏≤",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏î‡∏≤‡∏£‡∏±‡∏ï‡∏ô‡πå ‡πÅ‡∏™‡∏ô‡πÄ‡∏Ç‡∏∑‡πà‡∏≠‡∏ô",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏£‡∏ô‡∏¥‡∏©‡∏≤ ‡∏≠‡∏¥‡∏ô‡∏ï‡∏¥‡∏¢‡∏∞",
            "‡∏ô‡∏≤‡∏¢‡∏ô‡∏ó‡∏µ  ‡∏ó‡∏±‡∏®‡∏ô‡∏¥‡∏ï‡∏£‡πå",
            "‡∏ô‡∏≤‡∏¢‡∏ô‡∏¥‡∏£‡∏∏‡∏ï ‡∏£‡∏≤‡∏ç‡∏°‡∏µ‡∏ä‡∏±‡∏¢",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏∏‡πÑ‡∏£‡∏û‡∏£ ‡∏ñ‡∏≤‡∏Ñ‡∏≥",
            "‡∏ô‡∏≤‡∏á‡∏õ‡∏≤‡∏à‡∏£‡∏µ‡∏¢‡πå ‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏ß‡∏á‡∏®‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ì‡∏±‡∏è‡∏ê‡∏ì‡∏¥‡∏ä‡∏≤ ‡∏™‡∏∏‡∏ò‡∏£‡∏£‡∏°",
            "‡∏ô‡∏≤‡∏¢‡∏û‡∏¥‡∏û‡∏±‡∏í‡∏û‡∏á‡∏©‡πå ‡∏ß‡∏¥‡πÄ‡∏®‡∏©",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏£‡∏£‡∏ì‡∏ó‡∏¥‡∏û‡∏¢‡πå ‡∏õ‡∏≤‡∏Å‡∏î‡∏µ",
            "‡∏ô‡∏≤‡∏¢‡∏†‡∏±‡∏Ñ‡∏û‡∏• ‡∏¢‡∏∞‡∏†‡∏±‡∏Å‡∏î‡∏µ",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏£‡∏°‡∏ì ‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÄ‡∏à‡∏£‡∏¥‡∏ç",
            "‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥ ‡πÄ‡∏°‡∏ï‡∏∏‡∏•‡∏≤",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Ñ‡∏ì‡∏±‡∏ç‡∏ç‡∏≤ ‡∏û‡∏¥‡∏Å‡∏∏‡∏•‡∏ó‡∏≠‡∏á",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏°‡∏õ‡∏£‡∏≤‡∏£‡∏ñ‡∏ô‡∏≤ ‡∏ö‡∏∏‡∏ç‡πÄ‡∏û‡πá‡∏ä‡∏£‡πå",
            "‡∏ô‡∏≤‡∏¢‡∏™‡∏´‡∏±‡∏™‡∏ß‡∏£‡∏£‡∏© ‡∏ö‡∏∏‡∏ç‡∏®‡∏£‡∏µ",
            "‡∏ô‡∏≤‡∏¢‡∏ì‡∏±‡∏ê‡∏û‡∏• ‡∏Ñ‡∏π‡∏ì‡∏´‡∏•‡∏≤‡∏¢",
            "‡∏ô‡∏≤‡∏á‡∏†‡∏≤‡∏ß‡∏¥‡∏ì‡∏µ ‡∏™‡∏∏‡∏û‡∏•‡πÅ‡∏™‡∏á",
            "‡∏ô‡∏≤‡∏¢‡∏ä‡∏≤‡∏•‡∏µ ‡∏™‡∏∏‡∏û‡∏•‡πÅ‡∏™‡∏á",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏±‡∏ç‡∏ç‡∏≤‡∏û‡∏±‡∏ä‡∏£ ‡∏Ñ‡∏≥‡∏ä‡∏ô‡∏∞",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏•‡∏±‡∏î‡∏î‡∏≤‡∏û‡∏£ ‡πÅ‡∏™‡∏á‡∏ó‡∏≠‡∏á",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ä‡∏•‡∏±‡∏ô‡∏î‡∏≤ ‡∏õ‡∏£‡∏∞‡∏¢‡∏π‡∏£‡πÄ‡∏™‡∏≤‡∏ß‡∏†‡∏≤‡∏Ñ‡∏¢‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏£‡∏±‡∏ä‡∏û‡∏£ ‡∏ß‡πà‡∏≠‡∏á‡πÑ‡∏ß",
            "‡∏ô‡∏≤‡∏á‡∏ß‡∏¥‡∏•‡∏±‡∏¢‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå ‡∏à‡∏±‡∏ô‡∏ó‡∏∞‡∏Ç‡∏¥‡∏ô",
            "‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà ‡∏£.‡∏ï.‡∏ò‡∏ô‡∏ß‡∏±‡∏ï‡∏£ ‡∏î‡∏µ‡∏´‡∏•‡∏≤‡∏¢",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ö‡∏∏‡∏ì‡∏¢‡∏≤‡∏ô‡∏∏‡∏ä ‡∏ß‡∏¥‡∏ä‡∏±‡∏¢‡πÇ‡∏¢",
            "‡∏ô‡∏≤‡∏¢‡∏™‡∏±‡∏°‡∏§‡∏ó‡∏ò‡∏¥‡πå  ‡∏à‡∏¥‡∏Å‡∏à‡∏±‡∏Å‡∏£",
            "‡∏ô‡∏≤‡∏¢‡∏®‡∏∏‡∏†‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå ‡∏ú‡∏≤‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ",
            "‡∏ô‡∏≤‡∏á‡∏≠‡∏∏‡πÑ‡∏£ ‡∏≠‡∏∏‡∏ó‡∏±‡∏¢‡πÅ‡∏™‡∏ô",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ä‡∏±‡∏¢‡∏ì‡∏£‡∏µ ‡πÅ‡∏™‡∏ô‡πÄ‡∏•‡∏¥‡∏á",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏±‡∏ó‡∏°‡∏±‡∏¢ ‡∏ß‡∏∞‡∏¢‡∏∞‡∏•‡∏∏‡∏ô",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡∏¥‡∏†‡∏≤‡∏£‡∏±‡∏ï‡∏ô‡πå  ‡∏™‡∏∏‡∏ò‡∏£‡∏£‡∏°",
            "‡∏ô‡∏≤‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏ô‡∏≤‡∏ó‡∏¥‡∏û‡∏™‡πå ‡πÄ‡∏ß‡∏¨‡∏∏‡∏ß‡∏ô‡∏≤‡∏£‡∏±‡∏Å‡∏©‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡πÄ‡∏≠‡∏∑‡πâ‡∏≠‡∏≠‡∏≤‡∏£‡∏µ ‡πÄ‡∏≠‡∏Å‡∏û‡∏±‡∏ô‡∏ò‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏ô‡∏¥‡∏©‡∏ê‡∏≤ ‡∏®‡∏£‡∏µ‡∏ñ‡∏≤‡∏û‡∏£",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏†‡∏≤‡∏ß‡∏¥‡∏ï‡∏≤ ‡πÉ‡∏™‡∏™‡πà‡∏≠‡∏á",
            "‡∏ô‡∏≤‡∏¢‡∏™‡∏∏‡∏ó‡∏±‡∏®‡∏ô‡πå ‡∏¢‡∏≤‡∏°‡∏µ",
            "‡∏ô‡∏≤‡∏¢‡∏™‡∏∏‡∏ó‡∏±‡∏®‡∏ô‡πå ‡∏≠‡∏∏‡∏î‡∏°",
            "‡∏ô‡∏≤‡∏¢‡∏®‡∏¥‡∏£‡∏¥‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏õ‡∏¥‡∏•‡∏≠‡∏á",
            "‡∏ô‡∏≤‡∏¢‡∏ô‡∏±‡∏è‡∏ê‡∏û‡∏• ‡∏õ‡∏≤‡∏Å‡∏î‡∏µ",
            "‡∏ô‡∏≤‡∏¢‡∏™‡∏∏‡∏ä‡∏≤‡∏ï‡∏¥ ‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ß‡πÑ‡∏•‡∏†‡∏£‡∏ì‡πå ‡∏Ç‡∏£‡∏£‡∏Ñ‡πå‡∏®‡∏£",
            "‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏ß‡∏î‡∏µ‡∏®‡∏¥‡∏£‡∏¥‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå",
            "‡∏ô‡∏≤‡∏¢‡∏ó‡∏®‡∏û‡∏• ‡∏≠‡∏∏‡∏™‡∏≤‡∏û‡∏£‡∏´‡∏°",
            "‡∏ô‡∏≤‡∏¢‡∏û‡∏á‡∏©‡πå‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏•‡∏≤‡∏ô‡∏ô‡∏ó‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏°‡∏£‡∏ñ ‡∏£‡∏≤‡∏ä‡∏¥‡∏ß‡∏á‡∏®‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ó‡∏±‡∏©‡∏û‡∏¥‡∏ä‡∏≤ ‡∏ó‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏î‡∏≤ ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏Å‡πâ‡∏ß",
            "‡∏ô‡∏≤‡∏¢‡∏Å‡∏≤‡∏ô‡∏ï‡πå‡∏ô‡∏¥‡∏ò‡∏¥ ‡∏õ‡∏∞‡∏Å‡∏¥‡∏£‡∏∞‡∏Ñ‡∏∞",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏±‡∏ä‡∏£‡∏≤‡∏†‡∏£‡∏ì‡πå ‡∏Ñ‡∏ô‡∏¢‡∏∑‡∏ô",
            "‡∏ô‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏ç‡πå‡∏ß‡∏¥‡∏™‡∏¥‡∏ê ‡∏Å‡∏§‡∏©‡∏é‡∏¥‡πå‡∏û‡∏¥‡∏£‡πÄ‡∏°‡∏®",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏±‡∏°‡∏û‡∏£ ‡∏£‡∏±‡∏Å‡∏î‡∏µ",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏†‡∏Ñ‡∏ß‡∏î‡∏µ ‡∏ß‡∏£‡∏£‡∏ì‡∏ß‡∏á‡∏®‡πå",
            "‡∏ô‡∏≤‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏ô‡∏†‡∏≤ ‡∏≠‡∏£‡∏£‡∏Ñ‡∏™‡∏±‡∏á‡∏Ç‡πå",
            "‡∏ô‡∏≤‡∏á‡∏ó‡∏¥‡∏ï‡∏¥‡∏†‡∏≤ ‡πÅ‡∏™‡∏ô‡∏°‡∏∞‡∏Æ‡∏∏‡∏á",
            "‡∏ô‡∏≤‡∏¢‡∏¢‡∏∏‡∏ó‡∏ò‡∏Å‡∏≤‡∏£ ‡πÅ‡∏Å‡πâ‡∏ß‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏õ‡∏£‡∏≤‡∏ì‡∏µ‡∏ï ‡∏û‡∏£‡∏£‡∏ì‡∏ß‡∏á‡∏®‡πå",
            "‡∏ô‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î ‡πÑ‡∏ä‡∏¢‡∏Å‡∏≤",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ò‡∏±‡∏ç‡∏î‡∏≤  ‡πÇ‡∏ä‡∏ï‡∏¥‡∏ß‡∏∏‡∏í‡∏¥‡∏°‡∏ô‡∏ï‡∏£‡∏µ",
            "‡∏ô‡∏≤‡∏¢‡∏û‡∏∏‡∏ó ‡∏†‡∏π‡∏´‡∏≤‡∏î",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏ä‡∏ì‡∏¥‡∏ä‡∏≤ ‡∏≠‡∏≠‡∏ó‡∏∞‡∏Ç‡∏±‡∏ô‡∏ò‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏≤‡∏£‡∏¢‡∏≤ ‡∏ß‡∏£‡∏ß‡∏á‡∏®‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Ç‡∏±‡∏ï‡∏ï‡∏¥‡∏¢‡∏≤ ‡∏Ñ‡∏±‡∏ì‡∏ó‡∏±‡∏Å‡∏©‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡πÑ‡∏û‡∏•‡∏¥‡∏ô ‡∏ó‡∏±‡∏ô‡∏ö‡∏∏‡∏ç",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏¥‡∏ä‡∏ç‡πå‡∏ä‡∏≤‡∏ì‡∏¥‡∏Å‡∏≤ ‡∏Ñ‡∏ì‡∏≤‡∏ô‡∏±‡∏ô‡∏ó‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ä‡∏ç‡∏≤‡∏ô‡∏µ ‡∏ö‡∏∏‡∏ç‡∏°‡∏≤‡∏®",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ô‡∏¥‡∏†‡∏≤‡∏†‡∏±‡∏ó‡∏£ ‡πÅ‡∏Å‡πâ‡∏ß‡∏°‡∏∞",
            "Mr.Augustine Edongneck Endum",
            "Mrs.Jenneth Villamater Manuel",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ç‡∏≤‡∏ì‡∏¥‡∏ô‡∏ó‡πå  ‡∏Å‡∏ß‡∏î‡∏ß‡∏á‡∏®‡πå‡∏©‡∏≤",
            "‡∏ô‡∏≤‡∏¢‡∏≠‡∏≥‡∏ô‡∏≤‡∏à ‡∏®‡∏£‡∏µ‡∏†‡∏±‡∏Å‡∏î‡∏¥‡πå",
            "‡∏ô‡∏≤‡∏¢‡∏â‡∏±‡∏ï‡∏£‡∏ä‡∏é‡∏≤ ‡πÄ‡∏û‡∏ä‡∏£‡∏ß‡∏¥‡∏ä‡∏±‡∏¢",
            "‡∏ô‡∏≤‡∏¢‡∏≠‡∏±‡∏©‡∏é‡∏≤ ‡∏õ‡∏¥‡∏ï‡∏∞‡∏û‡∏£‡∏´‡∏°",
            "‡∏ô‡∏≤‡∏¢‡∏®‡∏∏‡∏†‡∏Å‡∏£ ‡∏ô‡∏≤‡∏Ñ‡∏ó‡∏±‡∏ö‡∏ó‡∏¥‡∏°",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏†‡∏¥‡∏ç‡∏ç‡∏î‡∏≤  ‡∏™‡∏∏‡∏Ç‡∏ß‡∏±‡∏ô",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏≤‡∏ß‡∏¥‡∏ï‡∏£‡∏µ ‡∏≠‡∏∏‡∏ó‡∏≥‡∏Å‡∏≤",
            "‡∏ô‡∏≤‡∏¢‡∏°‡∏≤‡πÇ‡∏ô‡∏ä ‡πÅ‡∏™‡∏ô‡∏®‡∏£‡∏µ",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏°‡∏ì‡∏ë‡∏¥‡∏Å‡∏≤‡∏ì‡πå ‡∏à‡∏±‡∏ô‡∏ó‡∏Ñ‡∏≤‡∏ï",
            "‡∏ô‡∏≤‡∏¢‡∏ì‡∏±‡∏ê‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‡∏™‡∏∏‡∏û‡∏£",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ä‡∏∏‡∏•‡∏µ‡∏û‡∏£ ‡∏ï‡πâ‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå",
            "‡∏ô‡∏≤‡∏¢‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏• ‡∏ï‡∏£‡∏µ‡∏®‡∏£‡∏µ",
            "‡∏ô‡∏≤‡∏¢‡∏≠‡∏≤‡∏ä‡∏≤ ‡πÄ‡∏Å‡∏∑‡πâ‡∏≠‡∏´‡∏ô‡∏≠‡∏á‡∏Ç‡∏∏‡πà‡∏ô",
            "‡∏ô‡∏≤‡∏¢‡∏§‡∏ó‡∏ò‡∏¥‡∏û‡∏£ ‡∏®‡∏£‡∏µ‡∏ß‡∏≤‡∏£‡∏°‡∏¢‡πå",
            "‡∏ô‡∏≤‡∏¢‡∏ô‡∏ó‡∏µ‡∏ò‡∏£ ‡∏ß‡∏á‡∏©‡πå‡∏ô‡∏≤‡∏£‡∏µ",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏°‡∏¥‡∏ô‡∏ï‡∏£‡∏≤ ‡∏™‡∏≤‡∏£‡∏¢‡∏®",
            "‡∏ô‡∏≤‡∏¢‡∏£‡∏±‡∏ï‡∏ô‡∏û‡∏±‡∏ô‡∏ò‡πå ‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏ß‡∏á‡∏®‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏±‡∏ï‡∏ñ‡∏à‡∏£‡∏¥‡∏¢‡∏≤ ‡∏°‡∏∏‡∏á‡∏Ñ‡∏∏‡∏ì",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏°‡∏ì‡∏µ‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏ß‡∏î‡∏µ‡∏®‡∏¥‡∏£‡∏¥‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏û‡∏¥‡∏°‡∏û‡∏£‡∏£‡∏ì‡πå ‡∏£‡∏≤‡∏ä‡∏°‡∏ì‡∏µ",
            "‡∏ô‡∏≤‡∏á‡∏ê‡∏¥‡∏ï‡∏≤‡∏ô‡∏±‡∏ô‡∏ó‡πå ‡∏ä‡∏°‡∏†‡∏π‡∏¢‡∏±‡∏ô‡∏ï‡πå",
            "‡∏ô‡∏≤‡∏¢‡∏™‡∏ß‡∏≤‡∏™‡∏î‡∏¥‡πå ‡∏ß‡∏á‡∏®‡πå‡∏û‡∏∏‡∏ó‡∏ò‡∏≤",
            "‡∏ô‡∏≤‡∏¢‡∏ò‡∏ô‡∏û‡∏• ‡∏Å‡∏≠‡∏á‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå",
            "‡∏ô‡∏≤‡∏¢‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì ‡∏ô‡∏∞‡∏î‡∏°",
            "‡∏ô‡∏≤‡∏¢‡∏û‡∏¥‡∏ä‡∏±‡∏¢  ‡∏™‡∏∏‡∏Ç‡∏†‡∏π‡∏ß‡∏á‡∏Ñ‡πå",
            "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏†‡∏≤‡∏û‡∏£ ‡∏ß‡∏±‡∏á‡∏ß‡∏¥‡∏™‡∏±‡∏¢",
            "‡∏ô‡∏≤‡∏á‡∏®‡∏∏‡∏†‡∏ô‡∏¥‡∏î‡∏≤ ‡∏™‡∏≤‡∏£‡∏∞‡πÇ‡∏û‡∏ò‡∏¥‡πå",
            "‡∏ô‡∏≤‡∏á‡∏¢‡∏∏‡∏û‡∏¥‡∏ô ‡∏•‡∏µ‡∏û‡∏£‡∏°",
            "‡∏ô‡∏≤‡∏¢‡∏ä‡∏£‡∏¥‡∏ô‡∏ó‡∏£  ‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏°",
            "‡∏ô‡∏≤‡∏¢‡∏ß‡∏±‡∏ä‡∏£‡∏Å‡∏£ ‡∏ô‡∏¥‡∏ó‡∏µ"
        ];

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCKv1S84RJyK8AzZwd-UwkmO4XxahcwRos",
            authDomain: "e-document-ed317.firebaseapp.com",
            projectId: "e-document-ed317",
            storageBucket: "e-document-ed317.firebasestorage.app",
            messagingSenderId: "920521182684",
            appId: "1:920521182684:web:4f54681f2367a44e5ed319",
            measurementId: "G-M3X6NEF5XY"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        let memos = [];
        let currentYear = new Date().getFullYear();

        // DOM Elements
        const fromSelect = document.getElementById('fromSelect');
        const fromOtherContainer = document.getElementById('fromOtherContainer');
        const fromOther = document.getElementById('fromOther');
        const toSelect = document.getElementById('toSelect');
        const toOther = document.getElementById('toOther');
        const memoForm = document.getElementById('memoForm');
        const memoPopup = document.getElementById('memoPopup');
        const historyTable = document.getElementById('historyTable');
        const yearFilter = document.getElementById('yearFilter');

        // Populate year filter
        async function populateYearFilter() {
            try {
                // Get all unique years from memos collection
                const snapshot = await db.collection('memos').get();
                const years = new Set();
                
                snapshot.forEach(doc => {
                    const data = doc.data();
                    if (data.year) {
                        years.add(data.year);
                    }
                });
                
                // Add current year if not in set
                years.add(currentYear);
                
                // Convert to sorted array (newest first)
                const yearArray = Array.from(years).sort((a, b) => b - a);
                
                // Populate dropdown
                yearFilter.innerHTML = yearArray.map(year => {
                    const thaiYear = year + 543; // Convert to Buddhist Era
                    return `<option value="${year}" ${year === currentYear ? 'selected' : ''}>‡∏û.‡∏®. ${thaiYear}</option>`;
                }).join('');
                
            } catch (error) {
                console.error('Error populating year filter:', error);
                // Add current year as fallback
                const thaiYear = currentYear + 543;
                yearFilter.innerHTML = `<option value="${currentYear}">‡∏û.‡∏®. ${thaiYear}</option>`;
            }
        }

        // Year filter change event
        yearFilter.addEventListener('change', function() {
            loadMemos(parseInt(this.value));
        });

        // Autocomplete function
        function autocomplete(inp, arr) {
            let currentFocus;
            
            inp.addEventListener("input", function(e) {
                let a, b, i, val = this.value;
                closeAllLists();
                if (!val) { return false; }
                currentFocus = -1;
                
                a = document.createElement("DIV");
                a.setAttribute("id", this.id + "autocomplete-list");
                a.setAttribute("class", "autocomplete-items");
                this.parentNode.appendChild(a);
                
                let count = 0;
                for (i = 0; i < arr.length; i++) {
                    if (arr[i].toUpperCase().includes(val.toUpperCase())) {
                        b = document.createElement("DIV");
                        b.innerHTML = arr[i];
                        b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
                        b.addEventListener("click", function(e) {
                            inp.value = this.getElementsByTagName("input")[0].value;
                            closeAllLists();
                        });
                        a.appendChild(b);
                        count++;
                        if (count >= 10) break; // Limit to 10 results
                    }
                }
            });
            
            inp.addEventListener("keydown", function(e) {
                let x = document.getElementById(this.id + "autocomplete-list");
                if (x) x = x.getElementsByTagName("div");
                if (e.keyCode == 40) {
                    currentFocus++;
                    addActive(x);
                } else if (e.keyCode == 38) {
                    currentFocus--;
                    addActive(x);
                } else if (e.keyCode == 13) {
                    e.preventDefault();
                    if (currentFocus > -1) {
                        if (x) x[currentFocus].click();
                    }
                }
            });
            
            function addActive(x) {
                if (!x) return false;
                removeActive(x);
                if (currentFocus >= x.length) currentFocus = 0;
                if (currentFocus < 0) currentFocus = (x.length - 1);
                x[currentFocus].classList.add("autocomplete-active");
            }
            
            function removeActive(x) {
                for (let i = 0; i < x.length; i++) {
                    x[i].classList.remove("autocomplete-active");
                }
            }
            
            function closeAllLists(elmnt) {
                let x = document.getElementsByClassName("autocomplete-items");
                for (let i = 0; i < x.length; i++) {
                    if (elmnt != x[i] && elmnt != inp) {
                        x[i].parentNode.removeChild(x[i]);
                    }
                }
            }
            
            document.addEventListener("click", function (e) {
                closeAllLists(e.target);
            });
        }

        // Initialize autocomplete for fromOther and requestor fields
        autocomplete(fromOther, staffNames);
        autocomplete(document.getElementById("requestor"), staffNames);

        // Show/Hide from other input field
        fromSelect.addEventListener('change', function() {
            fromOtherContainer.classList.toggle('hidden', this.value !== 'other');
            if (this.value !== 'other') fromOther.value = '';
        });

        // Show/Hide to other input field
        toSelect.addEventListener('change', function() {
            toOther.classList.toggle('hidden', this.value !== 'other');
            if (this.value !== 'other') toOther.value = '';
        });

        // Form submission
        memoForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const title = document.getElementById('title').value;
            const from = fromSelect.value === 'other' ? fromOther.value : fromSelect.value;
            const to = toSelect.value === 'other' ? toOther.value : toSelect.value;
            const requestor = document.getElementById('requestor').value;
            const notes = document.getElementById('notes').value;

            try {
                const currentYear = new Date().getFullYear();
                const counterDocId = `memoNumber_${currentYear}`;
                
                const counterDoc = await db.collection('counters').doc(counterDocId).get();
                let nextNumber = 1;
                
                if (counterDoc.exists) {
                    nextNumber = counterDoc.data().current + 1;
                }

                const memoNumber = `‡∏®‡∏ò 04305.037/${nextNumber}`;
                const timestamp = new Date();

                await db.collection('memos').add({
                    memoNumber,
                    title,
                    from,
                    to,
                    requestor,
                    notes,
                    timestamp,
                    number: nextNumber,
                    year: currentYear
                });

                await db.collection('counters').doc(counterDocId).set({
                    current: nextNumber,
                    year: currentYear
                });

                showMemoPopup(memoNumber, { title, from, to, requestor, notes, timestamp });
                
                memoForm.reset();
                fromOtherContainer.classList.add('hidden');
                toOther.classList.add('hidden');
                
                await populateYearFilter();
                loadMemos(currentYear);

            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
            }
        });

        // Show memo popup
        function showMemoPopup(memoNum, details) {
            document.getElementById('memoNumber').textContent = memoNum;
            document.getElementById('memoDetails').innerHTML = `
                <div><strong>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á:</strong> ${details.title}</div>
                <div><strong>‡∏à‡∏≤‡∏Å:</strong> ${details.from}</div>
                <div><strong>‡∏ñ‡∏∂‡∏á:</strong> ${details.to}</div>
                <div><strong>‡∏ú‡∏π‡πâ‡∏Ç‡∏≠‡πÄ‡∏•‡∏Ç:</strong> ${details.requestor}</div>
                ${details.notes ? `<div><strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ${details.notes}</div>` : ''}
                <div><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ${details.timestamp.toLocaleDateString('th-TH')}</div>
            `;
            memoPopup.classList.remove('hidden');
            memoPopup.classList.add('flex');
        }

        // Close popup
        document.getElementById('closePopup').addEventListener('click', function() {
            memoPopup.classList.add('hidden');
            memoPopup.classList.remove('flex');
        });

        // Load memos for main table
        async function loadMemos(year = currentYear) {
            try {
                // Get all memos and filter by year on client side
                const snapshot = await db.collection('memos')
                    .orderBy('timestamp', 'desc')
                    .get();
                
                memos = [];
                
                snapshot.forEach(doc => {
                    const data = doc.data();
                    // Filter by year on client side
                    if (data.year === year) {
                        memos.push({ id: doc.id, ...data });
                    }
                });

                displayMemos();
            } catch (error) {
                console.error('Error loading memos:', error);
                historyTable.innerHTML = `<tr><td colspan="6" class="border-b border-gray-100 px-6 py-8 text-center text-red-500">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: ${error.message}</td></tr>`;
            }
        }

        // Display memos in main table
        function displayMemos() {
            if (memos.length === 0) {
                const selectedYear = parseInt(yearFilter.value);
                const thaiYear = selectedYear + 543;
                historyTable.innerHTML = `<tr><td colspan="6" class="border-b border-gray-100 px-6 py-8 text-center text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏µ ‡∏û.‡∏®. ${thaiYear}</td></tr>`;
                return;
            }

            historyTable.innerHTML = memos.map(memo => `
                <tr class="table-row-hover transition-all duration-200">
                    <td class="border-b border-gray-100 px-3 md:px-6 py-3 md:py-4 font-medium text-orange-600 text-xs md:text-sm">${memo.memoNumber}</td>
                    <td class="border-b border-gray-100 px-3 md:px-6 py-3 md:py-4 text-xs md:text-sm">${memo.title}</td>
                    <td class="border-b border-gray-100 px-3 md:px-6 py-3 md:py-4 text-gray-600 text-xs md:text-sm hidden md:table-cell">${memo.from}</td>
                    <td class="border-b border-gray-100 px-3 md:px-6 py-3 md:py-4 text-gray-600 text-xs md:text-sm hidden md:table-cell">${memo.to}</td>
                    <td class="border-b border-gray-100 px-3 md:px-6 py-3 md:py-4 text-xs md:text-sm">${memo.requestor}</td>
                    <td class="border-b border-gray-100 px-3 md:px-6 py-3 md:py-4 text-gray-500 text-xs md:text-sm">${memo.timestamp.toDate().toLocaleDateString('th-TH')}</td>
                </tr>
            `).join('');
        }

        // Load memos on page load
        async function initializePage() {
            try {
                await populateYearFilter();
                await loadMemos(currentYear);
            } catch (error) {
                console.error('Error initializing page:', error);
                historyTable.innerHTML = `<tr><td colspan="6" class="border-b border-gray-100 px-6 py-8 text-center text-red-500">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</td></tr>`;
            }
        }
        
        initializePage();
    </script>
</body>
</html>

